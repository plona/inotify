#!/bin/bash

set -x
set -u

rm -fv /tmp/indp.err
rm -fv /tmp/indp.log

watch () {
    inotifywait -rme close_write . 1> /tmp/indp 2>/tmp/indp.err
}


show_files () {
    while read ev; do
        echo "## $ev ##" >> /tmp/indp.log
    done < /tmp/indp
}

watch &
disown

#show_files
#(show_files)&
show_files &
disown

sleep 1
while read line; do
    echo $line
done < /tmp/indp.err
